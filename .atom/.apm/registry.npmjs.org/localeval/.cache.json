{"_id":"localeval","_rev":"13-e011ff17d355d985f5082d25384cbc26","name":"localeval","description":"A sandboxed eval().","dist-tags":{"latest":"15.2.3"},"versions":{"13.12.11":{"name":"localeval","main":"localeval.js","description":"A sandboxed eval().","author":{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com","url":"http://espadrine.github.com/"},"contributors":[{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com"}],"version":"13.12.11","homepage":"http://espadrine.github.com/localeval/","repository":{"type":"git","url":"git://github.com/espadrine/localeval.git"},"dependencies":{},"devDependencies":{},"optionalDependencies":{},"engines":{"node":">=0.4.0"},"bugs":{"url":"https://github.com/espadrine/localeval/issues"},"_id":"localeval@13.12.11","dist":{"shasum":"9317b2622e0e2ab635d5cd67cd88f629d0d66475","tarball":"https://registry.npmjs.org/localeval/-/localeval-13.12.11.tgz"},"_from":".","_npmVersion":"1.3.8","_npmUser":{"name":"espadrine","email":"thaddee.tyl@gmail.com"},"maintainers":[{"name":"espadrine","email":"thaddee.tyl@gmail.com"}],"directories":{}},"15.2.3":{"name":"localeval","main":"localeval.js","description":"A sandboxed eval().","author":{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com","url":"http://espadrine.github.com/"},"contributors":[{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com"}],"version":"15.2.3","homepage":"http://espadrine.github.com/localeval/","repository":{"type":"git","url":"git://github.com/espadrine/localeval.git"},"dependencies":{},"devDependencies":{},"optionalDependencies":{},"engines":{"node":">=0.4.0"},"gitHead":"0bdec81a84e2a42994fd7e98eb3ad76c20063436","bugs":{"url":"https://github.com/espadrine/localeval/issues"},"_id":"localeval@15.2.3","scripts":{},"_shasum":"1617e569d968dc8a8f104a09932aa38190c39af9","_from":".","_npmVersion":"2.1.7","_nodeVersion":"0.10.29","_npmUser":{"name":"espadrine","email":"thaddee.tyl@gmail.com"},"maintainers":[{"name":"espadrine","email":"thaddee.tyl@gmail.com"}],"dist":{"shasum":"1617e569d968dc8a8f104a09932aa38190c39af9","tarball":"https://registry.npmjs.org/localeval/-/localeval-15.2.3.tgz"},"directories":{}},"13.4.14":{"name":"localeval","main":"main.js","description":"A sandboxed eval().","author":{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com","url":"http://espadrine.github.com/"},"contributors":[{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com"}],"version":"13.4.14","homepage":"http://espadrine.github.com/localeval/","repository":{"type":"git","url":"git://github.com/espadrine/localeval.git"},"dependencies":{},"devDependencies":{},"optionalDependencies":{},"engines":{"node":">=0.4.0"},"_id":"localeval@13.4.14","dist":{"shasum":"62858ac35a018a6c0a8014dd24baefceb1bf238a","tarball":"https://registry.npmjs.org/localeval/-/localeval-13.04.14.tgz"},"_from":".","_npmVersion":"1.2.17","_npmUser":{"name":"espadrine","email":"thaddee.tyl@gmail.com"},"maintainers":[{"name":"espadrine","email":"thaddee.tyl@gmail.com"}],"directories":{}},"13.5.13":{"name":"localeval","main":"main.js","description":"A sandboxed eval().","author":{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com","url":"http://espadrine.github.com/"},"contributors":[{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com"}],"version":"13.5.13","homepage":"http://espadrine.github.com/localeval/","repository":{"type":"git","url":"git://github.com/espadrine/localeval.git"},"dependencies":{},"devDependencies":{},"optionalDependencies":{},"engines":{"node":">=0.4.0"},"_id":"localeval@13.5.13","dist":{"shasum":"c947712264c71cc901c092d5d55139aae36de91f","tarball":"https://registry.npmjs.org/localeval/-/localeval-13.05.13.tgz"},"_from":".","_npmVersion":"1.2.17","_npmUser":{"name":"espadrine","email":"thaddee.tyl@gmail.com"},"maintainers":[{"name":"espadrine","email":"thaddee.tyl@gmail.com"}],"directories":{}},"13.5.29":{"name":"localeval","main":"main.js","description":"A sandboxed eval().","author":{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com","url":"http://espadrine.github.com/"},"contributors":[{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com"}],"version":"13.5.29","homepage":"http://espadrine.github.com/localeval/","repository":{"type":"git","url":"git://github.com/espadrine/localeval.git"},"dependencies":{},"devDependencies":{},"optionalDependencies":{},"engines":{"node":">=0.4.0"},"_id":"localeval@13.5.29","dist":{"shasum":"29cb10143f8f831d9df3b8a30c298a157bd1204f","tarball":"https://registry.npmjs.org/localeval/-/localeval-13.05.29.tgz"},"_from":".","_npmVersion":"1.2.17","_npmUser":{"name":"espadrine","email":"thaddee.tyl@gmail.com"},"maintainers":[{"name":"espadrine","email":"thaddee.tyl@gmail.com"}],"directories":{}},"13.6.10":{"name":"localeval","main":"localeval.js","description":"A sandboxed eval().","author":{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com","url":"http://espadrine.github.com/"},"contributors":[{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com"}],"version":"13.6.10","homepage":"http://espadrine.github.com/localeval/","repository":{"type":"git","url":"git://github.com/espadrine/localeval.git"},"dependencies":{},"devDependencies":{},"optionalDependencies":{},"engines":{"node":">=0.4.0"},"_id":"localeval@13.6.10","dist":{"shasum":"293f6d7b529f0d90f42394b82bd54e840a30397f","tarball":"https://registry.npmjs.org/localeval/-/localeval-13.06.10.tgz"},"_from":".","_npmVersion":"1.2.17","_npmUser":{"name":"espadrine","email":"thaddee.tyl@gmail.com"},"maintainers":[{"name":"espadrine","email":"thaddee.tyl@gmail.com"}],"directories":{}}},"readme":"# Local Eval\n\nEvaluate a string of JS code without access to the global object.\n\nAlways use that instead of `eval()`. Always.\n\nAPI:\n\n    localeval(code :: String, sandbox :: Object) :: Object.\n\n    localeval(code :: String,    sandbox :: Object,\n              timeout :: Number, cb :: Function)\n\nThe `code` is a string of JS code. The `sandbox` contains objects which are\ngoing to be accessible in the JS code.\nIt returns the last evaluated piece of JS code in `code`, if no timeout is\ngiven. Otherwise, after at most `timeout` milliseconds, the callback gives that\nresult as a parameter: `function(error, result) {…}`.\n\nNode example:\n\n```javascript\nvar localeval = require('localeval');\nlocaleval('console.log(\"Do I have access to the console?\")');  // Throws.\nlocaleval.clear();  // Kills processes used internally.\n```\n\nBrowser example:\n\n```html\n<!doctype html><title></title>\n<script src='localeval.js'></script>\n<!-- Alerts \"32\". -->\n<script> alert(localeval('a + b', {a: 14, b: 18})) </script>\n```\n\nYou may find an example of use in browser code in `main.html`.\n\n# Purpose\n\nTrying to find a reasonable cross-environment ES5 sandbox evaluation function.\n\nOffering a process-separated timeout-ed VM for node.\n\n# Warning\n\nIf no timeout is given, it doesn't protect your single-threaded code against\ninfinite loops. Additionally, the following leak:\n\n- `({}).constructor.getOwnPropertyNames = function(){return 'leak';}`\n- `Function(\"this.foo = 'leak'\")()`\n\nIf a timeout is given, an attacker can still use XHR:\n\n- `Function(\"this.XMLHttpRequest(…); …\")()`\n\nThat said, it protects against any security leak.\n\n1. All local and global variables are inaccessible.\n\n2. Variables defined while evaluating code don't pollute any scope.\n\n3. Evaluated code cannot fiddle with global object's properties.\n   Think\n   `localeval('([]).__proto__.push = function(a) { return \"nope\"; }')`.\n\n# Things to try\n\nIn comments are what should be executed outside the sandbox.\n\n```js\nString.prototype.slice = function() { return 'leaked'; };\n// 'nice'.slice(1) === 'ice'\nString.fromCharCode = function() { return 'leaked'; };\n// String.fromCharCode(42) === '*'\n// var foo = 1\nfoo = 7\nthis.foo = 7\nwindow.foo = 7\neval('foo = 7')\n// foo === 1\ndelete Number.parseInt\n// Number.parseInt('1337') === 1337\nString.prototype.leak = function() { return 'leak'; }\n// try { ''.leak() } catch(e) { /not a function/.test(e.message) }\n```\n\n---\n\nThis work is licensed under the Creative Commons Attribution 3.0 Unported\nLicense. To view a copy of this license, visit\n<http://creativecommons.org/licenses/by/3.0/>.\n","maintainers":[{"name":"espadrine","email":"thaddee.tyl@gmail.com"}],"time":{"modified":"2015-02-04T06:36:02.305Z","created":"2013-04-14T11:15:19.344Z","13.12.11":"2013-12-11T21:04:29.380Z","15.2.3":"2015-02-04T06:36:02.305Z","13.4.14":"2013-04-14T11:15:23.010Z","13.5.13":"2013-05-13T13:14:10.751Z","13.5.29":"2013-05-29T18:02:32.319Z","13.6.10":"2013-06-10T14:41:56.990Z"},"author":{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com","url":"http://espadrine.github.com/"},"repository":{"type":"git","url":"git://github.com/espadrine/localeval.git"},"homepage":"http://espadrine.github.com/localeval/","contributors":[{"name":"Thaddee Tyl","email":"thaddee.tyl@gmail.com"}],"bugs":{"url":"https://github.com/espadrine/localeval/issues"},"readmeFilename":"readme.md","_attachments":{},"_etag":"W/\"54d1bdd2-2330\"","_lastModified":"Wed, 04 Feb 2015 06:36:02 GMT"}