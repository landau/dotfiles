'use babel';

describe('Atom Clock', function () {

  var AtomClock = undefined;
  var workspaceElement = undefined;

  beforeEach(function () {
    workspaceElement = atom.views.getView(atom.workspace);
    jasmine.attachToDOM(workspaceElement);

    var statusBar = undefined;

    waitsForPromise(function () {
      return atom.packages.activatePackage('status-bar').then(function (pack) {
        statusBar = workspaceElement.querySelector('status-bar');
      });
    });

    waitsForPromise(function () {
      return atom.packages.activatePackage('atom-clock').then(function (clk) {
        AtomClock = clk.mainModule;
      });
    });

    waitsForPromise(function () {
      return atom.workspace.open();
    });
  });

  it('should properly load the package', function () {
    expect(AtomClock.atomClockView.element).toBeDefined();

    expect(AtomClock.config.dateFormat['default']).toBe('H:mm');
    expect(AtomClock.config.showTooltip['default']).toBe(false);
    expect(AtomClock.config.tooltipDateFormat['default']).toBe('LLLL');
    expect(AtomClock.config.locale['default']).toBe('en');
    expect(AtomClock.config.showUTC['default']).toBe(false);
    expect(AtomClock.config.refreshInterval['default']).toBe(60);
    expect(AtomClock.config.showClockIcon['default']).toBe(false);
  });

  it('should refresh the ticker when the date format is changed', function () {
    spyOn(AtomClock.atomClockView, 'refreshTicker');

    atom.config.set('atom-clock.dateFormat', 'H');
    expect(AtomClock.atomClockView.refreshTicker).toHaveBeenCalled();
  });

  it('should refresh the ticker when the tooltip date format is changed', function () {
    spyOn(AtomClock.atomClockView, 'refreshTicker');

    atom.config.set('atom-clock.tooltipDateFormat', 'H');
    expect(AtomClock.atomClockView.refreshTicker).toHaveBeenCalled();
  });

  it('should refresh the ticker when the UTC display setting is changed', function () {
    spyOn(AtomClock.atomClockView, 'refreshTicker');

    atom.config.set('atom-clock.showUTC', true);
    expect(AtomClock.atomClockView.refreshTicker).toHaveBeenCalled();
  });

  it('should refresh the ticker when the interval is changed', function () {
    spyOn(AtomClock.atomClockView, 'refreshTicker');

    atom.config.set('atom-clock.refreshInterval', '20');
    expect(AtomClock.atomClockView.refreshTicker).toHaveBeenCalled();
  });

  it('should set the configuration values when the tooltip is enabled', function () {
    spyOn(AtomClock.atomClockView, 'setConfigValues');

    atom.config.set('atom-clock.showTooltip', true);
    expect(AtomClock.atomClockView.setConfigValues).toHaveBeenCalled();
  });

  it('should set the configuration values when clock icon is requested', function () {
    spyOn(AtomClock.atomClockView, 'setConfigValues');

    atom.config.set('atom-clock.showClockIcon', true);
    expect(AtomClock.atomClockView.setConfigValues).toHaveBeenCalled();
  });

  it('should clear the ticker and restart it when refresh is called', function () {
    spyOn(AtomClock.atomClockView, 'clearTicker');
    spyOn(AtomClock.atomClockView, 'startTicker');

    atom.config.set('atom-clock.refreshInterval', '20');
    expect(AtomClock.atomClockView.clearTicker).toHaveBeenCalled();
    expect(AtomClock.atomClockView.startTicker).toHaveBeenCalled();
  });

  it('should hide the clock when toggled', function () {
    atom.commands.dispatch(document.querySelector('atom-workspace'), 'atom-clock:toggle');
    expect(AtomClock.atomClockView.element.style.display).toBe('none');

    atom.commands.dispatch(document.querySelector('atom-workspace'), 'atom-clock:toggle');
    expect(AtomClock.atomClockView.element.style.display).toBe('');
  });

  it('should toggle UTC mode when toggled', function () {
    atom.commands.dispatch(document.querySelector('atom-workspace'), 'atom-clock:utc-mode');
    expect(AtomClock.atomClockView.showUTC).toBe(true);

    atom.commands.dispatch(document.querySelector('atom-workspace'), 'atom-clock:utc-mode');
    expect(AtomClock.atomClockView.showUTC).toBe(false);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy90bGFuZGF1Ly5hdG9tL3BhY2thZ2VzL2F0b20tY2xvY2svc3BlYy9hdG9tLWNsb2NrLXNwZWMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsV0FBVyxDQUFDOztBQUVaLFFBQVEsQ0FBQyxZQUFZLEVBQUUsWUFBTTs7QUFFM0IsTUFBSSxTQUFTLFlBQUEsQ0FBQTtBQUNiLE1BQUksZ0JBQWdCLFlBQUEsQ0FBQTs7QUFFcEIsWUFBVSxDQUFDLFlBQU07QUFDZixvQkFBZ0IsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUE7QUFDckQsV0FBTyxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFBOztBQUVyQyxRQUFJLFNBQVMsWUFBQSxDQUFBOztBQUViLG1CQUFlLENBQUM7YUFBTSxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJLEVBQUs7QUFDL0UsaUJBQVMsR0FBRyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLENBQUE7T0FDekQsQ0FBQztLQUFBLENBQUMsQ0FBQTs7QUFFSCxtQkFBZSxDQUFDO2FBQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUMsR0FBRyxFQUFLO0FBQzlFLGlCQUFTLEdBQUcsR0FBRyxDQUFDLFVBQVUsQ0FBQTtPQUMzQixDQUFDO0tBQUEsQ0FBQyxDQUFBOztBQUVILG1CQUFlLENBQUM7YUFBTSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRTtLQUFBLENBQUMsQ0FBQTtHQUM3QyxDQUFDLENBQUE7O0FBRUYsSUFBRSxDQUFDLGtDQUFrQyxFQUFFLFlBQU07QUFDM0MsVUFBTSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7O0FBRXJELFVBQU0s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QyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUE7R0FDL0QsQ0FBQyxDQUFBOztBQUVGLElBQUUsQ0FBQyxxQ0FBcUMsRUFBRSxZQUFNO0FBQzlDLFFBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxxQkFBcUIsQ0FBQyxDQUFBO0FBQ3ZGLFVBQU0sQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTs7QUFFbEQsUUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLHFCQUFxQixDQUFDLENBQUE7QUFDdkYsVUFBTSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFBO0dBQ3BELENBQUMsQ0FBQTtDQUNILENBQUMsQ0FBQSIsImZpbGUiOiIvVXNlcnMvdGxhbmRhdS8uYXRvbS9wYWNrYWdlcy9hdG9tLWNsb2NrL3NwZWMvYXRvbS1jbG9jay1zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG5cbmRlc2NyaWJlKCdBdG9tIENsb2NrJywgKCkgPT4ge1xuXG4gIGxldCBBdG9tQ2xvY2tcbiAgbGV0IHdvcmtzcGFjZUVsZW1lbnRcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB3b3Jrc3BhY2VFbGVtZW50ID0gYXRvbS52aWV3cy5nZXRWaWV3KGF0b20ud29ya3NwYWNlKVxuICAgIGphc21pbmUuYXR0YWNoVG9ET00od29ya3NwYWNlRWxlbWVudClcblxuICAgIGxldCBzdGF0dXNCYXJcblxuICAgIHdhaXRzRm9yUHJvbWlzZSgoKSA9PiBhdG9tLnBhY2thZ2VzLmFjdGl2YXRlUGFja2FnZSgnc3RhdHVzLWJhcicpLnRoZW4oKHBhY2spID0+IHtcbiAgICAgIHN0YXR1c0JhciA9IHdvcmtzcGFjZUVsZW1lbnQucXVlcnlTZWxlY3Rvcignc3RhdHVzLWJhcicpXG4gICAgfSkpXG5cbiAgICB3YWl0c0ZvclByb21pc2UoKCkgPT4gYXRvbS5wYWNrYWdlcy5hY3RpdmF0ZVBhY2thZ2UoJ2F0b20tY2xvY2snKS50aGVuKChjbGspID0+IHtcbiAgICAgIEF0b21DbG9jayA9IGNsay5tYWluTW9kdWxlXG4gICAgfSkpXG5cbiAgICB3YWl0c0ZvclByb21pc2UoKCkgPT4gYXRvbS53b3Jrc3BhY2Uub3BlbigpKVxuICB9KVxuXG4gIGl0KCdzaG91bGQgcHJvcGVybHkgbG9hZCB0aGUgcGFja2FnZScsICgpID0+IHtcbiAgICBleHBlY3QoQXRvbUNsb2NrLmF0b21DbG9ja1ZpZXcuZWxlbWVudCkudG9CZURlZmluZWQoKVxuXG4gICAgZXhwZWN0KEF0b21DbG9jay5jb25maWcuZGF0ZUZvcm1hdC5kZWZhdWx0KS50b0JlKCdIOm1tJylcbiAgICBleHBlY3QoQXRvbUNsb2NrLmNvbmZpZy5zaG93VG9vbHRpcC5kZWZhdWx0KS50b0JlKGZhbHNlKVxuICAgIGV4cGVjdChBdG9tQ2xvY2suY29uZmlnLnRvb2x0aXBEYXRlRm9ybWF0LmRlZmF1bHQpLnRvQmUoJ0xMTEwnKVxuICAgIGV4cGVjdChBdG9tQ2xvY2suY29uZmlnLmxvY2FsZS5kZWZhdWx0KS50b0JlKCdlbicpXG4gICAgZXhwZWN0KEF0b21DbG9jay5jb25maWcuc2hvd1VUQy5kZWZhdWx0KS50b0JlKGZhbHNlKVxuICAgIGV4cGVjdChBdG9tQ2xvY2suY29uZmlnLnJlZnJlc2hJbnRlcnZhbC5kZWZhdWx0KS50b0JlKDYwKVxuICAgIGV4cGVjdChBdG9tQ2xvY2suY29uZmlnLnNob3dDbG9ja0ljb24uZGVmYXVsdCkudG9CZShmYWxzZSlcbiAgfSlcblxuICBpdCgnc2hvdWxkIHJlZnJlc2ggdGhlIHRpY2tlciB3aGVuIHRoZSBkYXRlIGZvcm1hdCBpcyBjaGFuZ2VkJywgKCkgPT4ge1xuICAgIHNweU9uKEF0b21DbG9jay5hdG9tQ2xvY2tWaWV3LCAncmVmcmVzaFRpY2tlcicpXG5cbiAgICBhdG9tLmNvbmZpZy5zZXQoJ2F0b20tY2xvY2suZGF0ZUZvcm1hdCcsICdIJylcbiAgICBleHBlY3QoQXRvbUNsb2NrLmF0b21DbG9ja1ZpZXcucmVmcmVzaFRpY2tlcikudG9IYXZlQmVlbkNhbGxlZCgpXG4gIH0pXG5cbiAgaXQoJ3Nob3VsZCByZWZyZXNoIHRoZSB0aWNrZXIgd2hlbiB0aGUgdG9vbHRpcCBkYXRlIGZvcm1hdCBpcyBjaGFuZ2VkJywgKCkgPT4ge1xuICAgIHNweU9uKEF0b21DbG9jay5hdG9tQ2xvY2tWaWV3LCAncmVmcmVzaFRpY2tlcicpXG5cbiAgICBhdG9tLmNvbmZpZy5zZXQoJ2F0b20tY2xvY2sudG9vbHRpcERhdGVGb3JtYXQnLCAnSCcpXG4gICAgZXhwZWN0KEF0b21DbG9jay5hdG9tQ2xvY2tWaWV3LnJlZnJlc2hUaWNrZXIpLnRvSGF2ZUJlZW5DYWxsZWQoKVxuICB9KVxuXG4gIGl0KCdzaG91bGQgcmVmcmVzaCB0aGUgdGlja2VyIHdoZW4gdGhlIFVUQyBkaXNwbGF5IHNldHRpbmcgaXMgY2hhbmdlZCcsICgpID0+IHtcbiAgICBzcHlPbihBdG9tQ2xvY2suYXRvbUNsb2NrVmlldywgJ3JlZnJlc2hUaWNrZXInKVxuXG4gICAgYXRvbS5jb25maWcuc2V0KCdhdG9tLWNsb2NrLnNob3dVVEMnLCB0cnVlKVxuICAgIGV4cGVjdChBdG9tQ2xvY2suYXRvbUNsb2NrVmlldy5yZWZyZXNoVGlja2VyKS50b0hhdmVCZWVuQ2FsbGVkKClcbiAgfSlcblxuICBpdCgnc2hvdWxkIHJlZnJlc2ggdGhlIHRpY2tlciB3aGVuIHRoZSBpbnRlcnZhbCBpcyBjaGFuZ2VkJywgKCkgPT4ge1xuICAgIHNweU9uKEF0b21DbG9jay5hdG9tQ2xvY2tWaWV3LCAncmVmcmVzaFRpY2tlcicpXG5cbiAgICBhdG9tLmNvbmZpZy5zZXQoJ2F0b20tY2xvY2sucmVmcmVzaEludGVydmFsJywgJzIwJylcbiAgICBleHBlY3QoQXRvbUNsb2NrLmF0b21DbG9ja1ZpZXcucmVmcmVzaFRpY2tlcikudG9IYXZlQmVlbkNhbGxlZCgpXG4gIH0pXG5cbiAgaXQoJ3Nob3VsZCBzZXQgdGhlIGNvbmZpZ3VyYXRpb24gdmFsdWVzIHdoZW4gdGhlIHRvb2x0aXAgaXMgZW5hYmxlZCcsICgpID0+IHtcbiAgICBzcHlPbihBdG9tQ2xvY2suYXRvbUNsb2NrVmlldywgJ3NldENvbmZpZ1ZhbHVlcycpXG5cbiAgICBhdG9tLmNvbmZpZy5zZXQoJ2F0b20tY2xvY2suc2hvd1Rvb2x0aXAnLCB0cnVlKVxuICAgIGV4cGVjdChBdG9tQ2xvY2suYXRvbUNsb2NrVmlldy5zZXRDb25maWdWYWx1ZXMpLnRvSGF2ZUJlZW5DYWxsZWQoKVxuICB9KVxuXG4gIGl0KCdzaG91bGQgc2V0IHRoZSBjb25maWd1cmF0aW9uIHZhbHVlcyB3aGVuIGNsb2NrIGljb24gaXMgcmVxdWVzdGVkJywgKCkgPT4ge1xuICAgIHNweU9uKEF0b21DbG9jay5hdG9tQ2xvY2tWaWV3LCAnc2V0Q29uZmlnVmFsdWVzJylcblxuICAgIGF0b20uY29uZmlnLnNldCgnYXRvbS1jbG9jay5zaG93Q2xvY2tJY29uJywgdHJ1ZSlcbiAgICBleHBlY3QoQXRvbUNsb2NrLmF0b21DbG9ja1ZpZXcuc2V0Q29uZmlnVmFsdWVzKS50b0hhdmVCZWVuQ2FsbGVkKClcbiAgfSlcblxuICBpdCgnc2hvdWxkIGNsZWFyIHRoZSB0aWNrZXIgYW5kIHJlc3RhcnQgaXQgd2hlbiByZWZyZXNoIGlzIGNhbGxlZCcsICgpID0+IHtcbiAgICBzcHlPbihBdG9tQ2xvY2suYXRvbUNsb2NrVmlldywgJ2NsZWFyVGlja2VyJylcbiAgICBzcHlPbihBdG9tQ2xvY2suYXRvbUNsb2NrVmlldywgJ3N0YXJ0VGlja2VyJylcblxuICAgIGF0b20uY29uZmlnLnNldCgnYXRvbS1jbG9jay5yZWZyZXNoSW50ZXJ2YWwnLCAnMjAnKVxuICAgIGV4cGVjdChBdG9tQ2xvY2suYXRvbUNsb2NrVmlldy5jbGVhclRpY2tlcikudG9IYXZlQmVlbkNhbGxlZCgpXG4gICAgZXhwZWN0KEF0b21DbG9jay5hdG9tQ2xvY2tWaWV3LnN0YXJ0VGlja2VyKS50b0hhdmVCZWVuQ2FsbGVkKClcbiAgfSlcblxuICBpdCgnc2hvdWxkIGhpZGUgdGhlIGNsb2NrIHdoZW4gdG9nZ2xlZCcsICgpID0+IHtcbiAgICBhdG9tLmNvbW1hbmRzLmRpc3BhdGNoKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2F0b20td29ya3NwYWNlJyksICdhdG9tLWNsb2NrOnRvZ2dsZScpXG4gICAgZXhwZWN0KEF0b21DbG9jay5hdG9tQ2xvY2tWaWV3LmVsZW1lbnQuc3R5bGUuZGlzcGxheSkudG9CZSgnbm9uZScpXG5cbiAgICBhdG9tLmNvbW1hbmRzLmRpc3BhdGNoKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2F0b20td29ya3NwYWNlJyksICdhdG9tLWNsb2NrOnRvZ2dsZScpXG4gICAgZXhwZWN0KEF0b21DbG9jay5hdG9tQ2xvY2tWaWV3LmVsZW1lbnQuc3R5bGUuZGlzcGxheSkudG9CZSgnJylcbiAgfSlcblxuICBpdCgnc2hvdWxkIHRvZ2dsZSBVVEMgbW9kZSB3aGVuIHRvZ2dsZWQnLCAoKSA9PiB7XG4gICAgYXRvbS5jb21tYW5kcy5kaXNwYXRjaChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdhdG9tLXdvcmtzcGFjZScpLCAnYXRvbS1jbG9jazp1dGMtbW9kZScpXG4gICAgZXhwZWN0KEF0b21DbG9jay5hdG9tQ2xvY2tWaWV3LnNob3dVVEMpLnRvQmUodHJ1ZSlcblxuICAgIGF0b20uY29tbWFuZHMuZGlzcGF0Y2goZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYXRvbS13b3Jrc3BhY2UnKSwgJ2F0b20tY2xvY2s6dXRjLW1vZGUnKVxuICAgIGV4cGVjdChBdG9tQ2xvY2suYXRvbUNsb2NrVmlldy5zaG93VVRDKS50b0JlKGZhbHNlKVxuICB9KVxufSlcbiJdfQ==