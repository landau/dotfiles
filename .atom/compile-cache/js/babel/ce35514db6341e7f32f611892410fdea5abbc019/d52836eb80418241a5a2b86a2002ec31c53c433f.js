function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _libCanvasLayer = require('../lib/canvas-layer');

var _libCanvasLayer2 = _interopRequireDefault(_libCanvasLayer);

'use babel';

describe('CanvasLayer', function () {
  var _ref = [];
  var layer = _ref[0];

  beforeEach(function () {
    layer = new _libCanvasLayer2['default']();

    layer.setSize(100, 300);
  });

  it('has two canvas', function () {
    expect(layer.canvas).toBeDefined();
    expect(layer.offscreenCanvas).toBeDefined();
  });

  it('has a context for each canvas', function () {
    expect(layer.context).toBeDefined();
    expect(layer.offscreenContext).toBeDefined();
  });

  it('disables the smoothing for the canvas', function () {
    expect(layer.canvas.webkitImageSmoothingEnabled).toBeFalsy();
    expect(layer.offscreenCanvas.webkitImageSmoothingEnabled).toBeFalsy();

    expect(layer.context.imageSmoothingEnabled).toBeFalsy();
    expect(layer.offscreenContext.imageSmoothingEnabled).toBeFalsy();
  });

  describe('.prototype.attach', function () {
    it('attaches the onscreen canvas to the provided element', function () {
      var jasmineContent = document.body.querySelector('#jasmine-content');

      layer.attach(jasmineContent);

      expect(jasmineContent.querySelector('canvas')).toExist();
    });
  });

  describe('.prototype.resetOffscreenSize', function () {
    it('sets the width of the offscreen canvas to the ', function () {
      layer.canvas.width = 500;
      layer.canvas.height = 400;

      expect(layer.offscreenCanvas.width).toEqual(100);
      expect(layer.offscreenCanvas.height).toEqual(300);

      layer.resetOffscreenSize();

      expect(layer.offscreenCanvas.width).toEqual(500);
      expect(layer.offscreenCanvas.height).toEqual(400);
    });
  });

  describe('.prototype.copyToOffscreen', function () {
    it('copies the onscreen bitmap onto the offscreen canvas', function () {
      spyOn(layer.offscreenContext, 'drawImage');

      layer.copyToOffscreen();

      expect(layer.offscreenContext.drawImage).toHaveBeenCalledWith(layer.canvas, 0, 0);
    });
  });

  describe('.prototype.copyFromOffscreen', function () {
    it('copies the offscreen bitmap onto the onscreen canvas', function () {
      spyOn(layer.context, 'drawImage');

      layer.copyFromOffscreen();

      expect(layer.context.drawImage).toHaveBeenCalledWith(layer.offscreenCanvas, 0, 0);
    });
  });

  describe('.prototype.copyPartFromOffscren', function () {
    it('copies to the onscreen canvas the region that were specified', function () {
      spyOn(layer.context, 'drawImage');

      layer.copyPartFromOffscreen(50, 100, 150);

      expect(layer.context.drawImage).toHaveBeenCalledWith(layer.offscreenCanvas, 0, 50, 100, 150, 0, 100, 100, 150);
    });
  });

  describe('.prototype.clearCanvas', function () {
    it('clears the whole canvas region', function () {
      spyOn(layer.context, 'clearRect');

      layer.clearCanvas();

      expect(layer.context.clearRect).toHaveBeenCalledWith(0, 0, layer.canvas.width, layer.canvas.height);
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy90bGFuZGF1L2RvdGZpbGVzLy5hdG9tL3BhY2thZ2VzL21pbmltYXAvc3BlYy9jYW52YXMtbGF5ZXItc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs4QkFFd0IscUJBQXFCOzs7O0FBRjdDLFdBQVcsQ0FBQTs7QUFJWCxRQUFRLENBQUMsYUFBYSxFQUFFLFlBQU07YUFDZCxFQUFFO01BQVgsS0FBSzs7QUFFVixZQUFVLENBQUMsWUFBTTtBQUNmLFNBQUssR0FBRyxpQ0FBaUIsQ0FBQTs7QUFFekIsU0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUE7R0FDeEIsQ0FBQyxDQUFBOztBQUVGLElBQUUsQ0FBQyxnQkFBZ0IsRUFBRSxZQUFNO0FBQ3pCLFVBQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7QUFDbEMsVUFBTSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtHQUM1QyxDQUFDLENBQUE7O0FBRUYsSUFBRSxDQUFDLCtCQUErQixFQUFFLFlBQU07QUFDeEMsVUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtBQUNuQyxVQUFNLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7R0FDN0MsQ0FBQyxDQUFBOztBQUVGLElBQUUsQ0FBQyx1Q0FBdUMsRUFBRSxZQUFNO0FBQ2hELFVBQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLDJCQUEyQixDQUFDLENBQUMsU0FBUyxFQUFFLENBQUE7QUFDNUQsVUFBTSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsMkJBQTJCLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQTs7QUFFckUsVUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMscUJBQXFCLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQTtBQUN2RCxVQUFNLENB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RSxHQUFHLENBQ2pCLENBQUE7S0FDRixDQUFDLENBQUE7R0FDSCxDQUFDLENBQUE7O0FBRUYsVUFBUSxDQUFDLHdCQUF3QixFQUFFLFlBQU07QUFDdkMsTUFBRSxDQUFDLGdDQUFnQyxFQUFFLFlBQU07QUFDekMsV0FBSyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLENBQUE7O0FBRWpDLFdBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQTs7QUFFbkIsWUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFBO0tBQ3BHLENBQUMsQ0FBQTtHQUNILENBQUMsQ0FBQTtDQUNILENBQUMsQ0FBQSIsImZpbGUiOiIvVXNlcnMvdGxhbmRhdS9kb3RmaWxlcy8uYXRvbS9wYWNrYWdlcy9taW5pbWFwL3NwZWMvY2FudmFzLWxheWVyLXNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGJhYmVsJ1xuXG5pbXBvcnQgQ2FudmFzTGF5ZXIgZnJvbSAnLi4vbGliL2NhbnZhcy1sYXllcidcblxuZGVzY3JpYmUoJ0NhbnZhc0xheWVyJywgKCkgPT4ge1xuICBsZXQgW2xheWVyXSA9IFtdXG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgbGF5ZXIgPSBuZXcgQ2FudmFzTGF5ZXIoKVxuXG4gICAgbGF5ZXIuc2V0U2l6ZSgxMDAsIDMwMClcbiAgfSlcblxuICBpdCgnaGFzIHR3byBjYW52YXMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KGxheWVyLmNhbnZhcykudG9CZURlZmluZWQoKVxuICAgIGV4cGVjdChsYXllci5vZmZzY3JlZW5DYW52YXMpLnRvQmVEZWZpbmVkKClcbiAgfSlcblxuICBpdCgnaGFzIGEgY29udGV4dCBmb3IgZWFjaCBjYW52YXMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KGxheWVyLmNvbnRleHQpLnRvQmVEZWZpbmVkKClcbiAgICBleHBlY3QobGF5ZXIub2Zmc2NyZWVuQ29udGV4dCkudG9CZURlZmluZWQoKVxuICB9KVxuXG4gIGl0KCdkaXNhYmxlcyB0aGUgc21vb3RoaW5nIGZvciB0aGUgY2FudmFzJywgKCkgPT4ge1xuICAgIGV4cGVjdChsYXllci5jYW52YXMud2Via2l0SW1hZ2VTbW9vdGhpbmdFbmFibGVkKS50b0JlRmFsc3koKVxuICAgIGV4cGVjdChsYXllci5vZmZzY3JlZW5DYW52YXMud2Via2l0SW1hZ2VTbW9vdGhpbmdFbmFibGVkKS50b0JlRmFsc3koKVxuXG4gICAgZXhwZWN0KGxheWVyLmNvbnRleHQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkKS50b0JlRmFsc3koKVxuICAgIGV4cGVjdChsYXllci5vZmZzY3JlZW5Db250ZXh0LmltYWdlU21vb3RoaW5nRW5hYmxlZCkudG9CZUZhbHN5KClcbiAgfSlcblxuICBkZXNjcmliZSgnLnByb3RvdHlwZS5hdHRhY2gnLCAoKSA9PiB7XG4gICAgaXQoJ2F0dGFjaGVzIHRoZSBvbnNjcmVlbiBjYW52YXMgdG8gdGhlIHByb3ZpZGVkIGVsZW1lbnQnLCAoKSA9PiB7XG4gICAgICBsZXQgamFzbWluZUNvbnRlbnQgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJyNqYXNtaW5lLWNvbnRlbnQnKVxuXG4gICAgICBsYXllci5hdHRhY2goamFzbWluZUNvbnRlbnQpXG5cbiAgICAgIGV4cGVjdChqYXNtaW5lQ29udGVudC5xdWVyeVNlbGVjdG9yKCdjYW52YXMnKSkudG9FeGlzdCgpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgnLnByb3RvdHlwZS5yZXNldE9mZnNjcmVlblNpemUnLCAoKSA9PiB7XG4gICAgaXQoJ3NldHMgdGhlIHdpZHRoIG9mIHRoZSBvZmZzY3JlZW4gY2FudmFzIHRvIHRoZSAnLCAoKSA9PiB7XG4gICAgICBsYXllci5jYW52YXMud2lkdGggPSA1MDBcbiAgICAgIGxheWVyLmNhbnZhcy5oZWlnaHQgPSA0MDBcblxuICAgICAgZXhwZWN0KGxheWVyLm9mZnNjcmVlbkNhbnZhcy53aWR0aCkudG9FcXVhbCgxMDApXG4gICAgICBleHBlY3QobGF5ZXIub2Zmc2NyZWVuQ2FudmFzLmhlaWdodCkudG9FcXVhbCgzMDApXG5cbiAgICAgIGxheWVyLnJlc2V0T2Zmc2NyZWVuU2l6ZSgpXG5cbiAgICAgIGV4cGVjdChsYXllci5vZmZzY3JlZW5DYW52YXMud2lkdGgpLnRvRXF1YWwoNTAwKVxuICAgICAgZXhwZWN0KGxheWVyLm9mZnNjcmVlbkNhbnZhcy5oZWlnaHQpLnRvRXF1YWwoNDAwKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJy5wcm90b3R5cGUuY29weVRvT2Zmc2NyZWVuJywgKCkgPT4ge1xuICAgIGl0KCdjb3BpZXMgdGhlIG9uc2NyZWVuIGJpdG1hcCBvbnRvIHRoZSBvZmZzY3JlZW4gY2FudmFzJywgKCkgPT4ge1xuICAgICAgc3B5T24obGF5ZXIub2Zmc2NyZWVuQ29udGV4dCwgJ2RyYXdJbWFnZScpXG5cbiAgICAgIGxheWVyLmNvcHlUb09mZnNjcmVlbigpXG5cbiAgICAgIGV4cGVjdChsYXllci5vZmZzY3JlZW5Db250ZXh0LmRyYXdJbWFnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgobGF5ZXIuY2FudmFzLCAwLCAwKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJy5wcm90b3R5cGUuY29weUZyb21PZmZzY3JlZW4nLCAoKSA9PiB7XG4gICAgaXQoJ2NvcGllcyB0aGUgb2Zmc2NyZWVuIGJpdG1hcCBvbnRvIHRoZSBvbnNjcmVlbiBjYW52YXMnLCAoKSA9PiB7XG4gICAgICBzcHlPbihsYXllci5jb250ZXh0LCAnZHJhd0ltYWdlJylcblxuICAgICAgbGF5ZXIuY29weUZyb21PZmZzY3JlZW4oKVxuXG4gICAgICBleHBlY3QobGF5ZXIuY29udGV4dC5kcmF3SW1hZ2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGxheWVyLm9mZnNjcmVlbkNhbnZhcywgMCwgMClcbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCcucHJvdG90eXBlLmNvcHlQYXJ0RnJvbU9mZnNjcmVuJywgKCkgPT4ge1xuICAgIGl0KCdjb3BpZXMgdG8gdGhlIG9uc2NyZWVuIGNhbnZhcyB0aGUgcmVnaW9uIHRoYXQgd2VyZSBzcGVjaWZpZWQnLCAoKSA9PiB7XG4gICAgICBzcHlPbihsYXllci5jb250ZXh0LCAnZHJhd0ltYWdlJylcblxuICAgICAgbGF5ZXIuY29weVBhcnRGcm9tT2Zmc2NyZWVuKDUwLCAxMDAsIDE1MClcblxuICAgICAgZXhwZWN0KGxheWVyLmNvbnRleHQuZHJhd0ltYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgbGF5ZXIub2Zmc2NyZWVuQ2FudmFzLFxuICAgICAgICAwLCA1MCwgMTAwLCAxNTAsXG4gICAgICAgIDAsIDEwMCwgMTAwLCAxNTBcbiAgICAgIClcbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCcucHJvdG90eXBlLmNsZWFyQ2FudmFzJywgKCkgPT4ge1xuICAgIGl0KCdjbGVhcnMgdGhlIHdob2xlIGNhbnZhcyByZWdpb24nLCAoKSA9PiB7XG4gICAgICBzcHlPbihsYXllci5jb250ZXh0LCAnY2xlYXJSZWN0JylcblxuICAgICAgbGF5ZXIuY2xlYXJDYW52YXMoKVxuXG4gICAgICBleHBlY3QobGF5ZXIuY29udGV4dC5jbGVhclJlY3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDAsIDAsIGxheWVyLmNhbnZhcy53aWR0aCwgbGF5ZXIuY2FudmFzLmhlaWdodClcbiAgICB9KVxuICB9KVxufSlcbiJdfQ==
//# sourceURL=/Users/tlandau/dotfiles/.atom/packages/minimap/spec/canvas-layer-spec.js
